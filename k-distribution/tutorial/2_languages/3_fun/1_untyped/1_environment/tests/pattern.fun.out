Solution 1
V ==K [ Pair ( 10 , ( 9 , .Exps ) ) , ( Pair ( 0 , ( 1 , .Exps ) ) , ( Pair ( 0 , ( 0 , .Exps ) ) , .Exps ) ) ] andBool ( _0 ==K <env> .Map </env> andBool _1 ==K <store> 1 |-> closure ( complex |-> 2 map |-> 3 length |-> 1 , ( [ .Exps ] -> 0 ) | ( ( [ h , .Exps | t ] -> ( 1 + length t ) ) | .Cases ) ) 2 |-> closure ( complex |-> 2 map |-> 3 length |-> 1 , ( Triple ( [ Pair ( h1 , ( h2 , .Exps ) ) , .Exps | t ] , ( l , ( [ Pair ( a , ( 2 , .Exps ) ) , ( Pair ( 3 , ( b , .Exps ) ) , ( c , .Exps ) ) ] , .Exps ) ) ) -> ( Pair ( ( h2 + length t + b ) , ( a , .Exps ) ) ) ) | ( ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ Pair ( 7 , ( 2 , .Exps ) ) , ( x , ( c , .Exps ) ) ] , .Exps ) ) ) -> x ) | ( ( default -> ( Pair ( 0 , ( 0 , .Exps ) ) ) ) | .Cases ) ) ) 3 |-> closure ( complex |-> 2 map |-> 3 length |-> 1 , ( f -> fun ( ( [ .Exps ] -> [ .Exps ] ) | ( ( [ h , .Exps | t ] -> ( cons ( f h ) ( map f t ) ) ) | .Cases ) ) ) | .Cases ) 4 |-> closure ( complex |-> 2 map |-> 3 length |-> 1 , ( Triple ( [ Pair ( h1 , ( h2 , .Exps ) ) , .Exps | t ] , ( l , ( [ Pair ( a , ( 2 , .Exps ) ) , ( Pair ( 3 , ( b , .Exps ) ) , ( c , .Exps ) ) ] , .Exps ) ) ) -> ( Pair ( ( h2 + length t + b ) , ( a , .Exps ) ) ) ) | ( ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ Pair ( 7 , ( 2 , .Exps ) ) , ( x , ( c , .Exps ) ) ] , .Exps ) ) ) -> x ) | ( ( default -> ( Pair ( 0 , ( 0 , .Exps ) ) ) ) | .Cases ) ) ) 5 |-> ( Triple ( [ Pair ( 8 , ( 7 , .Exps ) ) , .Exps ] , ( [ .Exps ] , ( [ Pair ( 9 , ( 2 , .Exps ) ) , ( Pair ( 3 , ( 3 , .Exps ) ) , ( Pair ( 2 , ( 2 , .Exps ) ) , .Exps ) ) ] , .Exps ) ) ) ) 6 |-> [ Triple ( [ .Exps ] , ( [ .Exps ] , ( [ Pair ( 7 , ( 2 , .Exps ) ) , ( Pair ( 0 , ( 1 , .Exps ) ) , ( Pair ( -1 , ( -1 , .Exps ) ) , .Exps ) ) ] , .Exps ) ) ) , ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ .Exps ] , .Exps ) ) ) , .Exps ) ] 7 |-> closure ( complex |-> 2 map |-> 3 length |-> 1 , ( Triple ( [ Pair ( h1 , ( h2 , .Exps ) ) , .Exps | t ] , ( l , ( [ Pair ( a , ( 2 , .Exps ) ) , ( Pair ( 3 , ( b , .Exps ) ) , ( c , .Exps ) ) ] , .Exps ) ) ) -> ( Pair ( ( h2 + length t + b ) , ( a , .Exps ) ) ) ) | ( ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ Pair ( 7 , ( 2 , .Exps ) ) , ( x , ( c , .Exps ) ) ] , .Exps ) ) ) -> x ) | ( ( default -> ( Pair ( 0 , ( 0 , .Exps ) ) ) ) | .Cases ) ) ) 8 |-> ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ Pair ( 7 , ( 2 , .Exps ) ) , ( Pair ( 0 , ( 1 , .Exps ) ) , ( Pair ( -1 , ( -1 , .Exps ) ) , .Exps ) ) ] , .Exps ) ) ) ) 9 |-> [ Triple ( [ .Exps ] , ( [ .Exps ] , ( [ .Exps ] , .Exps ) ) ) , .Exps ] 10 |-> closure ( complex |-> 2 map |-> 3 length |-> 1 , ( Triple ( [ Pair ( h1 , ( h2 , .Exps ) ) , .Exps | t ] , ( l , ( [ Pair ( a , ( 2 , .Exps ) ) , ( Pair ( 3 , ( b , .Exps ) ) , ( c , .Exps ) ) ] , .Exps ) ) ) -> ( Pair ( ( h2 + length t + b ) , ( a , .Exps ) ) ) ) | ( ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ Pair ( 7 , ( 2 , .Exps ) ) , ( x , ( c , .Exps ) ) ] , .Exps ) ) ) -> x ) | ( ( default -> ( Pair ( 0 , ( 0 , .Exps ) ) ) ) | .Cases ) ) ) 11 |-> ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ .Exps ] , .Exps ) ) ) ) 12 |-> [ .Exps ] 13 |-> closure ( complex |-> 2 map |-> 3 length |-> 1 , ( Triple ( [ Pair ( h1 , ( h2 , .Exps ) ) , .Exps | t ] , ( l , ( [ Pair ( a , ( 2 , .Exps ) ) , ( Pair ( 3 , ( b , .Exps ) ) , ( c , .Exps ) ) ] , .Exps ) ) ) -> ( Pair ( ( h2 + length t + b ) , ( a , .Exps ) ) ) ) | ( ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ Pair ( 7 , ( 2 , .Exps ) ) , ( x , ( c , .Exps ) ) ] , .Exps ) ) ) -> x ) | ( ( default -> ( Pair ( 0 , ( 0 , .Exps ) ) ) ) | .Cases ) ) ) 14 |-> ( Triple ( [ .Exps ] , ( [ .Exps ] , ( [ .Exps ] , .Exps ) ) ) ) 15 |-> ( Pair ( -1 , ( -1 , .Exps ) ) ) 16 |-> ( Pair ( 0 , ( 1 , .Exps ) ) ) 17 |-> 8 18 |-> 7 19 |-> ( Pair ( 2 , ( 2 , .Exps ) ) ) 20 |-> [ .Exps ] 21 |-> [ .Exps ] 22 |-> 9 23 |-> 3 </store> )
