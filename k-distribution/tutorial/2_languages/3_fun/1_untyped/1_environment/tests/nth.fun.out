Solution 1
V ==K [ 10 , ( 11 , ( 12 , ( 13 , ( 14 , .Exps ) ) ) ) ] andBool ( _0 ==K <env> .Map </env> andBool _1 ==K <store> 1 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( 1 -> fun ( ( [ h , .Exps | t ] -> h ) | .Cases ) ) | ( ( n -> fun ( ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) ) | .Cases ) ) 2 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( n -> fun ( ( m -> if n == m then [ n , .Exps ] else cons n ( nat ( n + 1 ) m ) ) | .Cases ) ) | .Cases ) 3 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( [ .Exps ] -> 0 ) | ( ( [ h , .Exps | t ] -> ( 1 + length t ) ) | .Cases ) ) 4 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( f -> fun ( ( [ .Exps ] -> [ .Exps ] ) | ( ( [ h , .Exps | t ] -> ( cons ( f h ) ( map f t ) ) ) | .Cases ) ) ) | .Cases ) 5 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( [ .Exps ] -> fun ( ( x -> [ .Exps ] ) | .Cases ) ) | ( ( [ h , .Exps | t ] -> fun ( ( x -> ( cons ( h x ) ( app t x ) ) ) | .Cases ) ) | .Cases ) ) 6 |-> 1 7 |-> 5 8 |-> 2 9 |-> 5 10 |-> 3 11 |-> 5 12 |-> 4 13 |-> 5 14 |-> 5 15 |-> 5 16 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( 1 -> fun ( ( [ h , .Exps | t ] -> h ) | .Cases ) ) | ( ( n -> fun ( ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) ) | .Cases ) ) 17 |-> 1 18 |-> [ 2 , ( 3 , ( 4 , ( 5 , .Exps ) ) ) ] 19 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( 1 -> fun ( ( [ h , .Exps | t ] -> h ) | .Cases ) ) | ( ( n -> fun ( ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) ) | .Cases ) ) 20 |-> 2 21 |-> [ 3 , ( 4 , ( 5 , .Exps ) ) ] 22 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( 1 -> fun ( ( [ h , .Exps | t ] -> h ) | .Cases ) ) | ( ( n -> fun ( ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) ) | .Cases ) ) 23 |-> 3 24 |-> [ 4 , ( 5 , .Exps ) ] 25 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( 1 -> fun ( ( [ h , .Exps | t ] -> h ) | .Cases ) ) | ( ( n -> fun ( ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) ) | .Cases ) ) 26 |-> 4 27 |-> [ 5 , .Exps ] 28 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( 1 -> fun ( ( [ h , .Exps | t ] -> h ) | .Cases ) ) | ( ( n -> fun ( ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) ) | .Cases ) ) 29 |-> 5 30 |-> [ .Exps ] 31 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( 1 -> fun ( ( [ h , .Exps | t ] -> h ) | .Cases ) ) | ( ( n -> fun ( ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) ) | .Cases ) ) 32 |-> 5 33 |-> 4 34 |-> 3 35 |-> 2 36 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 length |-> 3 , ( [ h , .Exps | t ] -> h ) | .Cases ) 37 |-> [ closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 35 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , ( closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 34 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , ( closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 33 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , ( closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 32 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , .Exps ) ) ) ] 38 |-> [ 10 , ( 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ) ] 39 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 35 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) 40 |-> [ closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 34 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , ( closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 33 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , ( closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 32 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , .Exps ) ) ] 41 |-> [ 10 , ( 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ) ] 42 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 34 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) 43 |-> [ closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 33 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , ( closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 32 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , .Exps ) ] 44 |-> [ 10 , ( 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ) ] 45 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 33 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) 46 |-> [ closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 32 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) , .Exps ] 47 |-> [ 10 , ( 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ) ] 48 |-> closure ( nat |-> 2 nth |-> 1 app |-> 5 map |-> 4 n |-> 32 length |-> 3 , ( [ h , .Exps | t ] -> ( nth ( n - 1 ) t ) ) | .Cases ) 49 |-> [ .Exps ] 50 |-> [ 10 , ( 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ) ] 51 |-> [ 10 , ( 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ) ] 52 |-> 10 53 |-> [ 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ] 54 |-> 4 55 |-> 11 56 |-> [ 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ] 57 |-> 3 58 |-> 12 59 |-> [ 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ] 60 |-> 2 61 |-> 13 62 |-> [ 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ] 63 |-> 14 64 |-> [ 15 , ( 16 , ( 17 , .Exps ) ) ] 65 |-> 10 66 |-> [ 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ] 67 |-> 3 68 |-> 11 69 |-> [ 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ] 70 |-> 2 71 |-> 12 72 |-> [ 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ] 73 |-> 13 74 |-> [ 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ] 75 |-> 10 76 |-> [ 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ] 77 |-> 2 78 |-> 11 79 |-> [ 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ] 80 |-> 12 81 |-> [ 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ] 82 |-> 10 83 |-> [ 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ] 84 |-> 11 85 |-> [ 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ] 86 |-> 10 87 |-> [ 11 , ( 12 , ( 13 , ( 14 , ( 15 , ( 16 , ( 17 , .Exps ) ) ) ) ) ) ] </store> )
